!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("lodash-es"),require("@angular/common"),require("@ngx-formly/core"),require("rxjs/operators"),require("rxjs"),require("@angular/forms"),require("@angular/core"),require("jquery")):"function"==typeof define&&define.amd?define("ngx-formly-designer",["exports","lodash-es","@angular/common","@ngx-formly/core","rxjs/operators","rxjs","@angular/forms","@angular/core","jquery"],t):t(e["ngx-formly-designer"]={},e.lodashEs,e.ng.common,e.core,e.rxjs.operators,e.rxjs,e.ng.forms,e.ng.core)}(this,function(e,p,t,r,n,i,a,o){"use strict";var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function l(e,t){function r(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function d(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}var f,c=(l(u,f=r.FieldWrapper),u.decorators=[{type:o.Component,args:[{selector:"formly-designer-wrapper",template:"\n        <ng-template #fieldComponent></ng-template>\n    "}]}],u.propDecorators={fieldComponent:[{type:o.ViewChild,args:["fieldComponent",{read:o.ViewContainerRef}]}]},u);function u(){return null!==f&&f.apply(this,arguments)||this}var h=new o.InjectionToken("FORMLY_DESIGNER_CONFIG_TOKEN"),m=(y.prototype.addConfig=function(e){e.settings&&this.setSettings(e.settings),e.types&&this.setType(e.types),e.wrappers&&this.setWrapper(e.wrappers)},y.prototype.setSettings=function(e){e.showClassName!==undefined&&(this.settings.showClassName=!!e.showClassName)},y.prototype.setType=function(e){var t=this;if(Array.isArray(e))e.forEach(function(e){t.setType(e)});else{this.formlyConfig.getType(e.name),this.types[e.name]||(this.types[e.name]={});var r=this.types[e.name];r.name=e.name,r.fieldArray=!!e.fieldArray,r.fieldGroup=!!e.fieldGroup,r.fields=e.fields}},y.prototype.setWrapper=function(e){var t=this;if(Array.isArray(e))e.forEach(function(e){t.setWrapper(e)});else{this.formlyConfig.getWrapper(e.name),this.wrappers[e.name]||(this.wrappers[e.name]={});var r=this.wrappers[e.name];r.name=e.name,r.fields=e.fields}},y.decorators=[{type:o.Injectable}],y.ctorParameters=function(){return[{type:Array,decorators:[{type:o.Inject,args:[h]}]},{type:r.FormlyConfig}]},y);function y(e,t){void 0===e&&(e=[]);var r=this;this.formlyConfig=t,this.types={},this.wrappers={},this.settings={showClassName:!0},e.forEach(function(e){return r.addConfig(e)})}var g="_formlyDesignerKeyPath";function v(e){var t,r;if(!e[g]||e[g].key!==e.key){var n=[];if(e.key){var i="string"==typeof e.key?e.key.split("."):e.key;try{for(var o=d(i),s=o.next();!s.done;s=o.next()){"string"==typeof(a=s.value)?(a=a.replace(/\[(\w+)\]/g,".$1"),n=n.concat(a.split("."))):n.push(a)}}catch(p){t={error:p}}finally{try{s&&!s.done&&(r=o["return"])&&r.call(o)}finally{if(t)throw t.error}}for(var l=0;l<n.length;l++){var a;"string"==typeof(a=n[l])&&/^\d+$/.test(a)&&(n[l]=parseInt(a,10))}}e[g]={key:e.key,path:n}}return e[g].path.slice()}function b(e,t,r,n){var i,o;r=r||[];try{for(var s=d(e),l=s.next();!l.done;l=s.next()){var a=l.value;if(t(a,r,n))return!0;if(a.fieldArray){if(b([a.fieldArray],t,r.concat(v(a)),a))return!0}else if(a.fieldGroup&&b(a.fieldGroup,t,r.concat(v(a)),a))return!0}}catch(p){i={error:p}}finally{try{l&&!l.done&&(o=s["return"])&&o.call(s)}finally{if(i)throw i.error}}}var C=Array.isArray,w=function(e){return"object"==typeof e&&null!=e},F=function(e){return"string"==typeof e||e instanceof String},D=(S.prototype.getFullKeyPath=function(e,t){var r=[];if(e&&e.key){var n=new Map;b(t,function(e,t,r){n.set(e,r)}),r=v(e);for(var i=n.get(e);i;)r=v(i).concat(r),i=n.get(i)}return r},S.prototype.getTypeFields=function(e){return this.getFields(e,"type")},S.prototype.getWrapperFields=function(e){return this.getFields(e,"wrapper")},S.prototype.checkField=function(o,e,t){var s=new Map,l=this.getFullKeyPath(t||{},e).concat(v(o)),a=l.length;return!b(e,function(e,t){var r=s.get(e)||s.set(e,(t||[]).concat(v(e))).get(e);if(r.length===a){for(var n=0;n<a;n++)if(r[n]!==l[n])return;return!function i(e,t){return!e.fieldArray==!t.fieldArray&&!e.fieldGroup==!t.fieldGroup}(o,e)}})},S.prototype.mutateField=function(e,t){return w(e.templateOptions)?e.templateOptions.$designerField=t:e.templateOptions={$designerField:t},e.fieldGroup?this.mutateFields(e.fieldGroup,t):e.fieldArray&&e.fieldArray.fieldGroup&&(t?this.mutateField(e.fieldArray,t):(e.templateOptions.$fieldArray={type:e.type},e.fieldGroup=e.fieldArray.fieldGroup,delete e.fieldArray,delete e.type,this.mutateFields(e.fieldGroup,t))),e},S.prototype.mutateFields=function(e,t){var r=this;e.forEach(function(e){return r.mutateField(e,t)})},S.prototype.getFields=function(e,t){var r=e&&this.getDesignerOptions(t)[e]||{},n=p.cloneDeep(r.fields||[]);return this.mutateFields(n,!0),n},S.prototype.getDesignerOptions=function(e){return"type"===e?this.formlyDesignerConfig.types:"wrapper"===e?this.formlyDesignerConfig.wrappers:{}},S.decorators=[{type:o.Injectable}],S.ctorParameters=function(){return[{type:m}]},S);function S(e){this.formlyDesignerConfig=e}var k=(Object.defineProperty(E.prototype,"disabled",{get:function(){return this._disabled.value},set:function(e){this._disabled.next(!!e)},enumerable:!0,configurable:!0}),Object.defineProperty(E.prototype,"disabled$",{get:function(){return this._disabled.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(E.prototype,"fields",{get:function(){return this._fields.value},set:function(e){var t=this.createPrunedFields(C(e)?e:[]);this._fields.next(t)},enumerable:!0,configurable:!0}),Object.defineProperty(E.prototype,"fields$",{get:function(){return this._fields.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(E.prototype,"model",{get:function(){return this._model.value},set:function(e){this._model.next(null==e?{}:e)},enumerable:!0,configurable:!0}),Object.defineProperty(E.prototype,"model$",{get:function(){return this._model.asObservable()},enumerable:!0,configurable:!0}),E.prototype.addField=function(e){this.fieldsService.mutateField(e,!1);var t=p.cloneDeep(this.fields);t.push(e),this.fields=t,this.model=p.cloneDeep(this.model)},E.prototype.removeField=function(e){this.unsetField(e),this.replaceField(this.fields,e,undefined)&&this.removeControl(e.formControl),this.fields=p.cloneDeep(this.fields),this.model=p.cloneDeep(this.model)},E.prototype.updateField=function(e,t){var r=this.fieldsService.mutateField(this.createPrunedField(t),!1);this.replaceField(this.fields,e,r)&&(e.formControl!==r.formControl&&(this.unsetField(e),this.removeControl(e.formControl)),this.fields=p.cloneDeep(this.fields),this.model=p.cloneDeep(this.model))},E.prototype.convertField=function(e){return this.createPrunedField(e)},E.prototype.convertFields=function(e){return this.createPrunedFields(e)},E.prototype.createDesignerFields=function(){return this.createPrunedFields(this.fields)},E.prototype.createPrunedFields=function(e){var r=this,n=[];return C(e)&&e.forEach(function(e){var t=r.createPrunedField(e);e.fieldArray?t.fieldArray=r.createPrunedField(e.fieldArray):e.fieldGroup&&!t.fieldArray&&(t.fieldGroup=r.createPrunedFields(e.fieldGroup)),0<Object.keys(t).length&&n.push(t)}),n},E.prototype.getWrappers=function(e){var t=this;if(!e||!C(e.wrappers))return[];var r=p.cloneDeep(e),n=r.wrappers=r.wrappers||[];!function(e){return"function"==typeof e}(this.designerConfig.settings.filterWrapper)||(n=n.filter(function(e){return t.designerConfig.settings.filterWrapper(e,r)}));var i=(e.type&&this.formlyConfig.getType(e.type).wrappers||[]).concat(this.formlyConfig.templateManipulators.preWrapper.map(function(e){return e(r)})).concat(this.formlyConfig.templateManipulators.postWrapper.map(function(e){return e(r)})).filter(function(e){return e});if(0<i.length)for(var o=n.length-1;0<=o;o--)for(var s=i.length-1;0<=s;s--)if(n[o]===i[s]){i.splice(s,1),n.splice(o,1);break}return n},E.prototype.createPrunedField=function(e){var t,r=this,n=p.get(e,"templateOptions.$fieldArray.type",e.type),i=this.designerConfig.types[n],o=function(e){if(e===undefined)return 1;if("function"==typeof e||"number"==typeof e||"boolean"==typeof e||"[object Date]"===Object.prototype.toString.call(e))return 0;if(null==e||0===e.length)return 1;if("object"!=typeof e)return 0;var t=void 0;for(var r in e)t=!1;return t}(e.key)?{}:{key:e.key};if(i&&(o.type=n,this.applyProperties(e,o,i.fields),i.fieldArray&&(o.fieldArray={fieldGroup:this.createPrunedFields(e.fieldGroup)})),C(e.fieldGroup)&&!C(o.fieldArray)){o.fieldGroup=this.createPrunedFields(e.fieldGroup);var s=void 0;F(e.fieldGroupClassName)&&0<(s=e.fieldGroupClassName.trim()).length&&(o.fieldGroupClassName=s)}F(e.className)&&0<(t=e.className.trim()).length&&(o.className=t);var l=this.getWrappers(e);if(0<l.length){var a=(o.wrappers=l).map(function(e){return r.designerConfig.wrappers[e]}).filter(function(e){return e&&C(e.fields)}).reduce(function(e,t){return e.concat(t.fields)},[]);this.applyProperties(e,o,a)}return o},E.prototype.applyProperties=function(r,n,e){C(e)&&e.forEach(function(e){var t=p.get(r,e.key);null!=t&&(!F(t)||0<t.length)&&t!==e.defaultValue&&p.set(n,e.key,t)})},E.prototype.replaceField=function(e,t,r){if(C(e))for(var n=e.length,i=0;i<n;i++){var o=e[i];if(o===t)return null==r?e.splice(i,1):e[i]=r,!0;if(o.fieldGroup&&this.replaceField(o.fieldGroup,t,r))return!0;if(o.fieldArray&&this.replaceFieldArray(o,t,r))return!0}return!1},E.prototype.replaceFieldArray=function(e,t,r){var n=e.fieldArray;return n===t?(e.fieldArray=r,!0):!(!n.fieldGroup||!this.replaceField(n.fieldGroup,t,r))||n.fieldArray&&this.replaceFieldArray(n,t,r)},E.prototype.buildPath=function(e,t,r){return void 0===r&&(r=!1),t?e+(r?t:"."+t):e},E.prototype.path=function(e,t){void 0===t&&(t=!0);var r="",n=!1;t||(e=(e||{}).parent);for(var i=e,o=(e||{}).parent;o;o=(i=o).parent)if(o instanceof a.FormGroup){for(var s in o.controls)if(o.controls[s]===i){r=this.buildPath(s,r,n),n=!1;break}}else if(o instanceof a.FormArray)for(var l=0;l<o.length;l++)if(o.at(l)===i){r=this.buildPath("["+l+"]",r,n),n=!0;break}return r},E.prototype.unsetField=function(e){var t=this;if(e&&(e.fieldArray&&this.unsetField(e.fieldArray),e.fieldGroup&&e.fieldGroup.forEach(function(e){return t.unsetField(e)}),e.formControl)){var r=this.path(e.formControl);p.unset(this.model,r)}},E.prototype.removeControl=function(e){var t=e?e.parent:undefined;if(t instanceof a.FormGroup){for(var r in t.controls)if(t.controls[r]===e)return void t.removeControl(r)}else if(t instanceof a.FormArray)for(var n=0;n<t.length;n++)if(t.at(n)===e)return void t.removeAt(n)},E.decorators=[{type:o.Injectable}],E.ctorParameters=function(){return[{type:m},{type:D},{type:r.FormlyConfig}]},E);function E(e,t,r){this.designerConfig=e,this.fieldsService=t,this.formlyConfig=r,this._disabled=new i.BehaviorSubject(!1),this._fields=new i.BehaviorSubject([]),this._model=new i.BehaviorSubject({})}var O,A=(l(G,O=r.FieldWrapper),G.prototype.ngOnInit=function(){this.type=this.field.type,this.wrappers=Object.getOwnPropertyNames(this.designerConfig.wrappers),this.fieldWrappers=this.formlyDesignerService.getWrappers(this.formlyDesignerService.convertField(this.field))||[]},G.prototype.ngAfterContentInit=function(){var e=this;this.zone.runOutsideAngular(function(){return setTimeout(function(){return e.checkDesigner()})})},G.prototype.ngAfterContentChecked=function(){var e=this;this.zone.runOutsideAngular(function(){return setTimeout(function(){return e.checkDesigner()})})},Object.defineProperty(G.prototype,"disabled",{get:function(){return this.formlyDesignerService.disabled},enumerable:!0,configurable:!0}),G.prototype.addWrapper=function(e){var t=p.cloneDeep(this.field);t.wrappers?t.wrappers.push(e):t.wrappers=[e],this.formlyDesignerService.updateField(this.field,t)},G.prototype.removeWrapper=function(e){var t=p.cloneDeep(this.field);this.fieldWrappers.splice(e,1),t.wrappers=this.fieldWrappers,this.formlyDesignerService.updateField(this.field,t)},G.prototype.edit=function(){this.editing=!0,this.formlyDesignerService.disabled=!0,this.fieldEdit.setValue(this.formlyDesignerService.convertField(p.cloneDeep(this.field)))},G.prototype.remove=function(){this.formlyDesignerService.removeField(this.field)},G.prototype.accept=function(){var e=this;this.fieldsService.checkField(this.fieldEdit.value,this.formlyDesignerService.fields)&&i.timer().subscribe(function(){e.formlyDesignerService.updateField(e.field,e.fieldEdit.value),e.formlyDesignerService.disabled=!1,e.editing=!1})},G.prototype.cancel=function(){this.formlyDesignerService.disabled=!1,this.editing=!1},G.prototype.checkDesigner=function(){var e=this.elementRef.nativeElement;if(null!=e.parentNode){var t=null==e.querySelector("formly-designer-wrapper");t!==e.classList.contains("designerEmpty")&&(this.changeDetector.detectChanges(),t?e.classList.add("designerEmpty"):e.classList.remove("designerEmpty"))}},G.decorators=[{type:o.Component,args:[{selector:"formly-designer-field-wrapper",template:'\n        <div *ngIf="!editing" class="bg-info text-white control-panel">\n            <span class="type">{{ type }}</span>\n            <div class="btn-group">\n                <button type="button" class="btn" data-toggle="dropdown"\n                    aria-haspopup="true" aria-expanded="false" title="wrappers">\n                    <i class="fa fa-clone" aria-hidden="true"></i>\n                </button>\n                <div class="dropdown-menu dropdown-menu-right">\n                    <button class="dropdown-item" type="button" [disabled]="disabled" title="add wrapper"\n                        *ngFor="let wrapper of wrappers" (click)="addWrapper(wrapper)">\n                        {{ wrapper }}\n                    </button>\n                    <ng-container *ngIf="fieldWrappers.length">\n                        <div *ngIf="wrappers.length" class="dropdown-divider"></div>\n                        <button class="dropdown-item" type="button" [disabled]="disabled"\n                            *ngFor="let wrapper of fieldWrappers; let i=index" (click)="removeWrapper(i)">\n                            {{ wrapper }}&nbsp;&nbsp;<i class="fa fa-times" aria-hidden="true" title="remove wrapper"></i>\n                        </button>\n                    </ng-container>\n                </div>\n            </div>\n            <button class="btn" type="button" [disabled]="disabled" (click)="edit()">\n                <i class="fa fa-pencil" aria-hidden="true" title="edit"></i>\n            </button>\n            <button class="btn" type="button" [disabled]="disabled" (click)="remove()">\n                <i class="fa fa-times" aria-hidden="true" title="remove"></i>\n            </button>\n        </div>\n        <div class="content">\n            <div class="editor" [hidden]="!editing">\n                <formly-designer-field-editor #editor [hasContent]="true" [showType]="true" [showWrappers]="true" [formControl]="fieldEdit">\n                    <div class="footer">\n                        <button (click)="cancel()" class="btn btn-secondary mr-1">Cancel</button>\n                        <button [disabled]="editor.invalid" (click)="accept()" class="btn btn-primary">Apply</button>\n                    </div>\n                </formly-designer-field-editor>\n            </div>\n            <div [hidden]="editing">\n                <ng-template #fieldComponent></ng-template>\n            </div>\n        </div>\n    ',styles:["\n        :host {\n            display: flex;\n            position: relative;\n            justify-content: flex-start;\n            align-content: flex-start;\n            align-items: flex-start;\n            margin: .25em;\n        }\n        :host.designerEmpty {\n            display:none;\n        }\n        .btn:not(:disabled), .dropdown-item:not(:disabled) {\n            cursor: pointer;\n        }\n        .control-panel {\n            font-size: .8em;\n            position: absolute;\n            padding: 0 0 0 .5em;\n            border-radius: 0 5px 0 0;\n            right: 0;\n            top: 0;\n        }\n        .control-panel > * {\n            padding-right: .5em;\n        }\n        .control-panel .btn {\n            font-size: unset;\n            background-color: unset;\n            padding: 0 .5em 0 0;\n            color: #fff;\n        }\n        .content {\n            border: 1px dashed #000;\n            border-radius: 5px;\n            min-height: 2em;\n            padding: 1.5em 1em 0 1em;\n            width: 100%;\n        }\n        .content:first-child {\n            padding-top: 0;\n        }\n        .editor {\n            margin: 1em 0;\n        }\n        .footer {\n            display: flex;\n            justify-content: flex-end;\n        }\n    "]}]}],G.ctorParameters=function(){return[{type:o.ChangeDetectorRef},{type:m},{type:o.ElementRef},{type:D},{type:k},{type:o.NgZone}]},G.propDecorators={fieldComponent:[{type:o.ViewChild,args:["fieldComponent",{read:o.ViewContainerRef}]}]},G);function G(e,t,r,n,i,o){var s=O.call(this)||this;return s.changeDetector=e,s.designerConfig=t,s.elementRef=r,s.fieldsService=n,s.formlyDesignerService=i,s.zone=o,s.editing=!1,s.fieldEdit=new a.FormControl({}),s.fieldWrappers=[],s.wrappers=[],s}var N,V=(l(x,N=r.FieldWrapper),x.prototype.ngOnInit=function(){this.field.templateOptions.$fieldArray?this.type=this.field.templateOptions.$fieldArray.type||"fieldArray":this.field.type?this.type=this.field.type:this.field.fieldGroup&&(this.type="fieldGroup"),this.wrappers=Object.getOwnPropertyNames(this.designerConfig.wrappers),this.fieldWrappers=this.formlyDesignerService.convertField(this.field).wrappers||[]},x.prototype.ngAfterContentInit=function(){var e=this;this.zone.runOutsideAngular(function(){return setTimeout(function(){return e.checkDesigner()})})},x.prototype.ngAfterContentChecked=function(){var e=this;this.zone.runOutsideAngular(function(){return setTimeout(function(){return e.checkDesigner()})})},Object.defineProperty(x.prototype,"disabled",{get:function(){return this.formlyDesignerService.disabled},enumerable:!0,configurable:!0}),x.prototype.addWrapper=function(e){var t=p.cloneDeep(this.field);t.wrappers?t.wrappers.push(e):t.wrappers=[e],this.formlyDesignerService.updateField(this.field,t)},x.prototype.removeWrapper=function(e){var t=p.cloneDeep(this.field);this.fieldWrappers.splice(e,1),t.wrappers=this.fieldWrappers,this.formlyDesignerService.updateField(this.field,t)},x.prototype.edit=function(){this.editing=!0,this.formlyDesignerService.disabled=!0,this.fieldEdit.setValue(this.formlyDesignerService.convertField(p.cloneDeep(this.field)))},x.prototype.remove=function(){this.formlyDesignerService.removeField(this.field)},x.prototype.accept=function(){var e=this;this.fieldsService.checkField(this.fieldEdit.value,this.formlyDesignerService.fields)&&i.timer().subscribe(function(){e.formlyDesignerService.updateField(e.field,e.fieldEdit.value),e.formlyDesignerService.disabled=!1,e.editing=!1})},x.prototype.cancel=function(){this.formlyDesignerService.disabled=!1,this.editing=!1},x.prototype.onFieldSelected=function(e){var t=this;if(!C(this.field.fieldGroup)||this.fieldsService.checkField(e,this.formlyDesignerService.fields,this.field)){var r=p.cloneDeep(this.field);r.fieldGroup=C(r.fieldGroup)?r.fieldGroup.slice():[],r.fieldGroup.push(e),i.timer().pipe(n.tap(function(){return t.formlyDesignerService.updateField(t.field,r)}),n.catchError(function(){return i.NEVER})).subscribe()}},x.prototype.checkDesigner=function(){var e=this.elementRef.nativeElement;if(null!=e.parentNode){var t=null==e.querySelector("formly-designer-wrapper");t!==e.classList.contains("designerEmpty")&&(this.changeDetector.detectChanges(),t?e.classList.add("designerEmpty"):e.classList.remove("designerEmpty"))}},x.decorators=[{type:o.Component,args:[{selector:"formly-designer-field-group-wrapper",template:'\n        <div *ngIf="!editing" class="bg-info text-white control-panel">\n            <span class="type">{{ type }}</span>\n            <div class="btn-group">\n                <button type="button" class="btn" data-toggle="dropdown"\n                    aria-haspopup="true" aria-expanded="false" title="wrappers">\n                    <i class="fa fa-clone" aria-hidden="true"></i>\n                </button>\n                <div class="dropdown-menu dropdown-menu-right">\n                    <button class="dropdown-item" type="button" [disabled]="disabled" title="add wrapper"\n                        *ngFor="let wrapper of wrappers" (click)="addWrapper(wrapper)">\n                        {{ wrapper }}\n                    </button>\n                    <ng-container *ngIf="fieldWrappers.length">\n                        <div *ngIf="wrappers.length" class="dropdown-divider"></div>\n                        <button class="dropdown-item" type="button" [disabled]="disabled"\n                            *ngFor="let wrapper of fieldWrappers; let i=index" (click)="removeWrapper(i)">\n                            {{ wrapper }}&nbsp;&nbsp;<i class="fa fa-times" aria-hidden="true" title="remove wrapper"></i>\n                        </button>\n                    </ng-container>\n                </div>\n            </div>\n            <button [disabled]="disabled" type="button" class="btn" (click)="edit()">\n                <i class="fa fa-pencil" aria-hidden="true" title="edit"></i>\n            </button>\n            <button [disabled]="disabled" type="button" class="btn" (click)="remove()">\n                <i class="fa fa-times" aria-hidden="true" title="remove"></i>\n            </button>\n        </div>\n        <div class="content">\n            <div [hidden]="!editing">\n                <formly-designer-field-editor #editor [fieldGroup]="true" [hasContent]="true" [showWrappers]="true"\n                    [formControl]="fieldEdit">\n                    <div class="footer">\n                        <button (click)="cancel()" class="btn btn-secondary mr-1">Cancel</button>\n                        <button [disabled]="editor.invalid" (click)="accept()" class="btn btn-primary">Apply</button>\n                    </div>\n                </formly-designer-field-editor>\n            </div>\n            <div [hidden]="editing">\n                <div class="form-group">\n                    <label>child</label>\n                    <formly-designer-field-picker (selected)="onFieldSelected($event)"></formly-designer-field-picker>\n                </div>\n                <ng-template #fieldComponent></ng-template>\n            </div>\n        </div>\n    ',styles:["\n        :host {\n            display: flex;\n            position: relative;\n            justify-content: flex-start;\n            align-content: flex-start;\n            align-items: flex-start;\n            margin: .25em;\n        }\n        :host.designerEmpty {\n            display:none;\n        }\n        .btn:not(:disabled), .dropdown-item:not(:disabled) {\n            cursor: pointer;\n        }\n        .control-panel {\n            font-size: .8em;\n            position: absolute;\n            padding: 0 0 0 .5em;\n            border-radius: 0 5px 0 0;\n            right: 0;\n            top: 0;\n        }\n        .control-panel > * {\n            padding-right: .5em;\n        }\n        .control-panel .btn {\n            font-size: unset;\n            background-color: unset;\n            padding: 0 .5em 0 0;\n            color: #fff;\n        }\n        .content {\n            border: 1px dashed #000;\n            border-radius: 5px;\n            padding: 1em;\n            width: 100%;\n        }\n        .footer {\n            display: flex;\n            justify-content: flex-end;\n        }\n    "]}]}],x.ctorParameters=function(){return[{type:o.ChangeDetectorRef},{type:m},{type:o.ElementRef},{type:D},{type:k},{type:o.NgZone}]},x.propDecorators={fieldComponent:[{type:o.ViewChild,args:["fieldComponent",{read:o.ViewContainerRef}]}]},x);function x(e,t,r,n,i,o){var s=N.call(this)||this;return s.changeDetector=e,s.designerConfig=t,s.elementRef=r,s.fieldsService=n,s.formlyDesignerService=i,s.zone=o,s.editing=!1,s.fieldEdit=new a.FormControl({}),s.fieldWrappers=[],s.wrappers=[],s}var P=(j.prototype.isNonDesignerField=function(e){return e&&(!e.templateOptions||!0!==e.templateOptions.$designerField)},j.prototype.run=function(e){var t=this;e.templateManipulators.preWrapper.push(function(e){if(t.isNonDesignerField(e))return e.fieldGroup?"fieldGroupDesigner":"fieldDesigner"}),e.templateManipulators.postWrapper.push(function(e){if(t.isNonDesignerField(e))return"designer"})},j);function j(){}var W=[],I=[c,A,V],_={wrappers:[{name:"designer",component:c},{name:"fieldDesigner",component:A},{name:"fieldGroupDesigner",component:V}],manipulators:[{"class":P,method:"run"}]},T=(Object.defineProperty(R.prototype,"disabled",{get:function(){return this.formlyDesignerService.disabled},set:function(e){this.formlyDesignerService.disabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(R.prototype,"fields",{get:function(){return this.formlyDesignerService.fields},set:function(e){var t=this.formlyDesignerService.convertFields(e);this.fieldsService.mutateFields(t,!1),this.formlyDesignerService.fields=t},enumerable:!0,configurable:!0}),Object.defineProperty(R.prototype,"model",{get:function(){return this.formlyDesignerService.model},set:function(e){this.formlyDesignerService.model=e},enumerable:!0,configurable:!0}),R.prototype.ngOnInit=function(){var e=this;this.form=this.formBuilder.group({}),this.subscriptions.push(this.formlyDesignerService.fields$.subscribe(function(){e.form=e.formBuilder.group({}),e.fieldsChange.emit(e.formlyDesignerService.createDesignerFields())})),this.subscriptions.push(i.merge(this.formlyDesignerService.model$,this.form.valueChanges).pipe(n.debounceTime(50)).subscribe(function(){return e.modelChange.emit(e.formlyDesignerService.model)}))},R.prototype.ngOnDestroy=function(){this.subscriptions.splice(0).forEach(function(e){return e.unsubscribe()})},R.prototype.onFieldSelected=function(e){var t=this;i.timer().pipe(n.tap(function(){t.fieldsService.checkField(e,t.formlyDesignerService.fields)&&t.formlyDesignerService.addField(e)}),n.catchError(function(){return i.NEVER})).subscribe()},R.decorators=[{type:o.Component,args:[{selector:"formly-designer",template:'\n        <formly-designer-field-picker (selected)="onFieldSelected($event)">\n        </formly-designer-field-picker>\n        <form novalidate [formGroup]="form">\n            <formly-form [options]="options" [model]="model" [form]="form" [fields]="fields">\n            </formly-form>\n        </form>\n        \x3c!--<div>\n            Designer Fields Debug:\n            <pre>{{ fields | decycle | json }}</pre>\n        </div>--\x3e\n    ',encapsulation:o.ViewEncapsulation.None,providers:[k],styles:["\n        formly-designer-field-picker .form-group > .input-group > formly-designer-type-select > select {\n            border-radius: .25rem 0 0 .25rem;\n            border-right: 0;\n        }\n        formly-designer-wrapper-editor .card > .card-body .form-control {\n            width: 100%;\n        }\n        formly-designer-wrapper-picker .form-group > .input-group > formly-designer-wrapper-select > select {\n            border-radius: .25rem 0 0 .25rem;\n            border-right: 0;\n        }\n    "]}]}],R.ctorParameters=function(){return[{type:D},{type:a.FormBuilder},{type:k}]},R.propDecorators={formlyFormContainer:[{type:o.ViewChild,args:["formlyFormContainer",{read:o.ViewContainerRef}]}],fieldsChange:[{type:o.Output}],modelChange:[{type:o.Output}],disabled:[{type:o.Input}],fields:[{type:o.Input}],model:[{type:o.Input}]},R);function R(e,t,r){this.fieldsService=e,this.formBuilder=t,this.formlyDesignerService=r,this.fieldsChange=new o.EventEmitter,this.modelChange=new o.EventEmitter,this.types=[],this.wrappers=[],this.properties=[],this.debugFields=[],this.options={},this.subscriptions=[]}var M={provide:a.NG_VALUE_ACCESSOR,useExisting:o.forwardRef(function(){return q}),multi:!0},q=(B.prototype.ngOnInit=function(){var e=this;this.subscriptions.push(this.type.valueChanges.subscribe(function(){return e.onTypeChange()})),this.subscriptions.push(this.form.statusChanges.pipe(n.debounceTime(0)).subscribe(function(){return e.invalid=e.form.invalid})),this.subscribeValueChanges()},B.prototype.ngOnDestroy=function(){this.valueChangesSubscription.unsubscribe(),this.subscriptions.splice(0).forEach(function(e){return e.unsubscribe()})},B.prototype.writeValue=function(e){this.valueChangesSubscription.unsubscribe(),this.updateField(e),this.form.markAsPristine(),this.form.markAsUntouched(),this.subscribeValueChanges()},B.prototype.registerOnChange=function(e){this.onChange=e},B.prototype.registerOnTouched=function(e){this.onTouched=e},B.prototype.setDisabledState=function(e){e?this.form.disable():this.form.enable()},B.prototype.subscribeValueChanges=function(){var e=this;this.valueChangesSubscription=i.merge(this.fieldForm.valueChanges,this.form.valueChanges).pipe(n.debounceTime(0)).subscribe(function(){return e.updateValue()})},B.prototype.updateField=function(e){w(e)||(e={}),this.key.setValue(F(e.key)?e.key:""),this.className.setValue(F(e.className)?e.className:""),this.fieldGroupClassName.setValue(F(e.fieldGroupClassName)?e.fieldGroupClassName:""),this.type.setValue(F(e.type)?e.type:""),this.fields=this.fieldsService.getTypeFields(this.type.value),this.fieldForm=this.fb.group({}),this.field=p.cloneDeep(e)},B.prototype.updateValue=function(){if(this.onChange){var e=this.field;e.key=this.key.value,e.className=this.className.value,e.fieldGroupClassName=this.fieldGroupClassName.value,e.type=this.type.value,this.onChange(e)}},B.prototype.onTypeChange=function(){this.valueChangesSubscription.unsubscribe();var e=this.type.value;this.fields=this.fieldsService.getTypeFields(e);var t=this.formlyDesignerConfig.types[e];this.fieldArray=t&&t.fieldArray,this.fieldForm=this.fb.group({}),this.field=Object.assign({},this.field),this.subscribeValueChanges()},B.prototype.onWrappersSelected=function(e){this.updateField(e)},B.prototype.validator=function(e){var t=e.get("type"),r=F(t.value)&&0<t.value.trim().length,n=e.get("key"),i={key:!1,type:this.showType&&!r,conflict:!1};return!r||F(n.value)&&0!==n.value.trim().length||(i.key=!0),i.key||i.type?i:null},B.decorators=[{type:o.Component,args:[{selector:"formly-designer-field-editor",template:'\n        <form [formGroup]="form" novalidate>\n            <div class="card">\n                <div class="card-header" [ngClass]="{solo: !hasContent && fields.length === 0}">\n                    <div class="form-group" [ngClass]="{\'has-danger\': form.hasError(\'key\') && (key.dirty || key.touched)}">\n                        <label class="form-control-label">key</label>\n                        <input formControlName="key" class="form-control">\n                        <div *ngIf="form.hasError(\'key\') && (key.dirty || key.touched)" class="form-control-feedback">\n                            key required.\n                        </div>\n                    </div>\n                    <div *ngIf="formlyDesignerConfig.settings.showClassName" class="form-group">\n                        <label class="form-control-label">className</label>\n                        <input formControlName="className" class="form-control">\n                    </div>\n                    <div *ngIf="fieldGroup && formlyDesignerConfig.settings.showClassName" class="form-group">\n                        <label class="form-control-label">fieldGroupClassName</label>\n                        <input formControlName="fieldGroupClassName" class="form-control">\n                    </div>\n                    <div *ngIf="showType" class="form-group"\n                        [ngClass]="{\'has-danger\': form.hasError(\'type\') && (type.dirty || type.touched)}">\n                        <label class="form-control-label">type</label>\n                        <formly-designer-type-select formControlName="type"></formly-designer-type-select>\n                        <div *ngIf="form.hasError(\'type\') && (type.dirty || type.touched)" class="form-control-feedback">\n                            type required.\n                        </div>\n                    </div>\n                    <div *ngIf="showWrappers" class="form-group">\n                        <label class="form-control-label">wrappers</label>\n                        <formly-designer-wrappers-picker [field]="field"\n                            (selected)="onWrappersSelected($event)">\n                        </formly-designer-wrappers-picker>\n                    </div>\n                </div>\n                <div #block class="card-body">\n                    <formly-form *ngIf="fields.length > 0" [form]="fieldForm" [fields]="fields" [model]="field">\n                    </formly-form>\n                    <ng-content></ng-content>\n                </div>\n            </div>\n        </form>\n    ',providers:[M],styles:["\n        .card-header.solo {\n            border-bottom: 0;\n        }\n        .card-header.solo + .card-body {\n            display: none;\n        }\n    "]}]}],B.ctorParameters=function(){return[{type:D},{type:a.FormBuilder},{type:m}]},B.propDecorators={fieldGroup:[{type:o.Input}],showType:[{type:o.Input}],showWrappers:[{type:o.Input}],hasContent:[{type:o.Input}],blockElRef:[{type:o.ViewChild,args:["block"]}]},B);function B(e,t,r){var n=this;this.fieldsService=e,this.fb=t,this.formlyDesignerConfig=r,this.subscriptions=[],this.field={},this.fields=[],this.onChange=function(e){},this.onTouched=function(){},this.form=t.group({key:this.key=t.control(""),className:this.className=t.control(""),fieldGroupClassName:this.fieldGroupClassName=t.control(""),type:this.type=t.control("")},{validator:function(e){return n.validator(e)}}),this.fieldForm=t.group({})}var L=(Object.defineProperty(z.prototype,"$modal",{get:function(){return $(this.modalRef.nativeElement)},enumerable:!0,configurable:!0}),z.prototype.add=function(){var e=this.type.value,t={};"fieldGroup"!==e&&(t.type=e);var r=this.formlyDesignerConfig.types[e]||{};r.fieldArray&&(t.fieldArray={fieldGroup:[]}),(this.fieldGroup="fieldGroup"===e||r.fieldGroup)&&(t.fieldGroup=[]),this.fieldEdit.setValue(t),this.$modal.modal("show")},z.prototype.onApply=function(){this.selected.emit(this.fieldEdit.value),this.$modal.modal("hide")},z.decorators=[{type:o.Component,args:[{selector:"formly-designer-field-picker",template:'\n        <form novalidate [formGroup]="form">\n            <div class="form-group">\n                <div class="input-group">\n                    <formly-designer-type-select formControlName="type">\n                    </formly-designer-type-select>\n                    <button type="button" class="btn btn-secondary" [disabled]="form.invalid" (click)="add()">\n                        Add\n                    </button>\n                </div>\n            </div>\n            <div #modal class="modal fade" tabindex="-1" role="dialog">\n                <div class="modal-dialog modal-lg" role="document">\n                    <div class="modal-content">\n                        <div class="modal-header">\n                            <h5 class="modal-title">Add {{ type.value }}</h5>\n                            <button type="button" class="close" data-dismiss="modal" aria-label="Cancel">\n                                <span aria-hidden="true">&times;</span>\n                            </button>\n                        </div>\n                        <div class="modal-body">\n                            <formly-designer-field-editor #editor [fieldGroup]="fieldEdit.value.fieldGroup" [formControl]="fieldEdit">\n                            </formly-designer-field-editor>\n                        </div>\n                        <div class="modal-footer">\n                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>\n                            <button type="button" class="btn btn-primary" (click)="onApply()"\n                                [disabled]="editor.invalid">Apply</button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </form>\n    ',styles:["\n        .btn:not(:disabled) {\n            cursor: pointer;\n        }\n        .input-group > .btn {\n            border-radius: 0 .25rem .25rem 0;\n        }\n        .input-group, .modal-header {\n            display: flex;\n        }\n        .modal-header {\n            justify-content: space-between;\n        }\n        formly-designer-type-select {\n            flex-grow: 2;\n        }\n    "]}]}],z.ctorParameters=function(){return[{type:a.FormBuilder},{type:m}]},z.propDecorators={modalRef:[{type:o.ViewChild,args:["modal"]}],selected:[{type:o.Output}]},z);function z(e,t){this.formlyDesignerConfig=t,this.selected=new o.EventEmitter,this.fieldEdit=new a.FormControl({}),this.form=e.group({type:this.type=e.control("",a.Validators.compose([a.Validators.required,a.Validators.pattern(/^\s*\S.*$/)]))})}var K={provide:a.NG_VALUE_ACCESSOR,useExisting:o.forwardRef(function(){return U}),multi:!0},U=(Y.prototype.ngAfterViewInit=function(){var e=this;i.timer().subscribe(function(){e.types=Object.keys(e.formlyDesignerConfig.types),0<e.types.length&&e.formControl.setValue(e.types[0]),e.types.push("fieldGroup")})},Y.prototype.ngOnInit=function(){var t=this;this.valueChangesSubscription=this.formControl.valueChanges.subscribe(function(e){t.onChange&&t.onChange(e)})},Y.prototype.ngOnDestroy=function(){this.valueChangesSubscription.unsubscribe()},Y.prototype.writeValue=function(e){this.formControl.setValue(e)},Y.prototype.registerOnChange=function(e){this.onChange=e},Y.prototype.registerOnTouched=function(e){this.onTouched=e},Y.prototype.setDisabledState=function(e){e?this.formControl.disable():this.formControl.enable()},Y.decorators=[{type:o.Component,args:[{selector:"formly-designer-type-select",template:'\n        <select [formControl]="formControl" class="custom-select">\n            <option *ngFor="let type of types" [ngValue]="type">{{ type }}</option>\n        </select>\n    ',providers:[K],styles:["\n        select {\n            width: 100%;\n        }\n    "]}]}],Y.ctorParameters=function(){return[{type:m}]},Y);function Y(e){this.formlyDesignerConfig=e,this.formControl=new a.FormControl,this.onChange=function(e){},this.onTouched=function(){}}var Z={provide:a.NG_VALUE_ACCESSOR,useExisting:o.forwardRef(function(){return H}),multi:!0},H=(J.prototype.ngOnInit=function(){var e=this;this.subscriptions.push(this.fieldForm.statusChanges.pipe(n.switchMap(function(){return i.timer()})).subscribe(function(){return e.invalid=e.fieldForm.invalid})),this.subscribeValueChanges()},J.prototype.ngOnDestroy=function(){this.valueChangesSubscription.unsubscribe(),this.subscriptions.splice(0).forEach(function(e){return e.unsubscribe()})},J.prototype.ngOnChanges=function(e){e.wrapper&&(this.valueChangesSubscription&&this.valueChangesSubscription.unsubscribe(),this.fields=this.fieldsService.getWrapperFields(this.wrapper),this.fieldForm=this.formBuilder.group({}),this.field=Object.assign({},this.field),this.valueChangesSubscription&&this.subscribeValueChanges())},J.prototype.writeValue=function(e){this.valueChangesSubscription.unsubscribe(),w(e)||(e={}),this.fields=this.fieldsService.getWrapperFields(this.wrapper),this.fieldForm=this.formBuilder.group({}),this.field=p.cloneDeep(e),this.subscribeValueChanges()},J.prototype.registerOnChange=function(e){this.onChange=e},J.prototype.registerOnTouched=function(e){this.onTouched=e},J.prototype.setDisabledState=function(e){e?this.fieldForm.disable():this.fieldForm.enable()},J.prototype.subscribeValueChanges=function(){var e=this;this.valueChangesSubscription=this.fieldForm.valueChanges.pipe(n.debounceTime(0)).subscribe(function(){return e.updateValue()})},J.prototype.updateValue=function(){this.onChange&&this.onChange(this.field)},J.decorators=[{type:o.Component,args:[{selector:"formly-designer-wrapper-editor",template:'\n        <form [formGroup]="fieldForm" novalidate>\n            <div class="card">\n                <div class="card-body">\n                    <formly-form [form]="fieldForm" [fields]="fields" [model]="field">\n                    </formly-form>\n                    <ng-content></ng-content>\n                </div>\n            </div>\n        </form>\n    ',providers:[Z]}]}],J.ctorParameters=function(){return[{type:D},{type:a.FormBuilder}]},J.propDecorators={wrapper:[{type:o.Input}]},J);function J(e,t){this.fieldsService=e,this.formBuilder=t,this.subscriptions=[],this.fields=[],this.onChange=function(e){},this.onTouched=function(){},this.fieldForm=t.group({})}var Q={provide:a.NG_VALUE_ACCESSOR,useExisting:o.forwardRef(function(){return X}),multi:!0},X=(ee.prototype.ngAfterViewInit=function(){var e=this;i.timer().subscribe(function(){e.wrappers=Object.keys(e.formlyDesignerConfig.wrappers),0<e.wrappers.length&&e.formControl.setValue(e.wrappers[0])})},ee.prototype.ngOnInit=function(){var t=this;this.valueChangesSubscription=this.formControl.valueChanges.subscribe(function(e){t.onChange&&t.onChange(e)})},ee.prototype.ngOnDestroy=function(){this.valueChangesSubscription.unsubscribe()},ee.prototype.writeValue=function(e){this.formControl.setValue(e)},ee.prototype.registerOnChange=function(e){this.onChange=e},ee.prototype.registerOnTouched=function(e){this.onTouched=e},ee.prototype.setDisabledState=function(e){e?this.formControl.disable():this.formControl.enable()},ee.decorators=[{type:o.Component,args:[{selector:"formly-designer-wrapper-select",template:'\n        <select [formControl]="formControl" class="custom-select">\n            <option *ngFor="let wrapper of wrappers" [ngValue]="wrapper">{{ wrapper }}</option>\n        </select>\n    ',providers:[Q],styles:["\n        select {\n            width: 100%;\n        }\n    "]}]}],ee.ctorParameters=function(){return[{type:m}]},ee);function ee(e){this.formlyDesignerConfig=e,this.formControl=new a.FormControl,this.onChange=function(e){},this.onTouched=function(){}}var te=(Object.defineProperty(re.prototype,"wrapper",{get:function(){return this.form.get("wrapper").value},enumerable:!0,configurable:!0}),Object.defineProperty(re.prototype,"$modal",{get:function(){return $(this.modalRef.nativeElement)},enumerable:!0,configurable:!0}),re.prototype.ngOnInit=function(){this.form=this.formBuilder.group({wrapper:["",a.Validators.compose([a.Validators.required,a.Validators.pattern(/^\s*\S.*$/)])]})},re.prototype.add=function(){if(w(this.field)){var e=p.cloneDeep(this.field);C(e.wrappers)&&0<e.wrappers.length?e.wrappers.splice(e.wrappers.length-1,0,this.wrapper):e.wrappers=[this.wrapper],this.fieldEdit.setValue(e);var t=this.formlyDesignerConfig.wrappers[this.wrapper].fields;C(t)&&0<t.length?this.$modal.modal("show"):this.onApply()}},re.prototype.onApply=function(){this.field=this.formlyDesignerService.convertField(this.fieldEdit.value),this.selected.emit(this.fieldEdit.value),this.$modal.modal("hide")},re.decorators=[{type:o.Component,args:[{selector:"formly-designer-wrapper-picker",template:'\n        <form novalidate [formGroup]="form">\n            <div class="form-group">\n                <div class="input-group">\n                    <formly-designer-wrapper-select formControlName="wrapper">\n                    </formly-designer-wrapper-select>\n                    <button type="button" class="btn btn-secondary" [disabled]="form.invalid" (click)="add()">\n                        Add\n                    </button>\n                </div>\n            </div>\n            <div #modal class="modal fade" tabindex="-1" role="dialog">\n                <div class="modal-dialog modal-lg" role="document">\n                    <div class="modal-content">\n                        <div class="modal-header">\n                            <h5 class="modal-title">Add {{ wrapper }}</h5>\n                            <button type="button" class="close" data-dismiss="modal" aria-label="Cancel">\n                                <span aria-hidden="true">&times;</span>\n                            </button>\n                        </div>\n                        <div class="modal-body">\n                            <formly-designer-wrapper-editor #editor [formControl]="fieldEdit" [wrapper]="wrapper">\n                            </formly-designer-wrapper-editor>\n                        </div>\n                        <div class="modal-footer">\n                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>\n                            <button type="button" class="btn btn-primary" (click)="onApply()"\n                                [disabled]="editor.invalid">Apply</button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </form>\n    ',styles:["\n        :host {\n            width: inherit;\n        }\n        .btn:not(:disabled) {\n            cursor: pointer;\n        }\n        .input-group > .btn {\n            border-radius: 0 .25rem .25rem 0;\n        }\n        .input-group, .modal-header {\n            display: flex;\n        }\n        .modal-header {\n            justify-content: space-between;\n        }\n        formly-designer-wrapper-select {\n            flex-grow: 2;\n        }\n    "]}]}],re.ctorParameters=function(){return[{type:a.FormBuilder},{type:m},{type:k}]},re.propDecorators={modalRef:[{type:o.ViewChild,args:["modal"]}],field:[{type:o.Input}],selected:[{type:o.Output}]},re);function re(e,t,r){this.formBuilder=e,this.formlyDesignerConfig=t,this.formlyDesignerService=r,this.selected=new o.EventEmitter,this.fieldEdit=new a.FormControl({})}var ne=(ie.prototype.ngOnChanges=function(e){e.field&&(this.wrappers=this.formlyDesignerService.getWrappers(e.field.currentValue))},Object.defineProperty(ie.prototype,"$modal",{get:function(){return $(this.modalRef.nativeElement)},enumerable:!0,configurable:!0}),ie.prototype.onWrapperSelected=function(e){this.selected.emit(e)},ie.prototype.edit=function(e){if(this.wrapper=this.wrappers[e],w(this.field)){var t=p.cloneDeep(this.field);if(C(t.wrappers)){this.fieldEdit.setValue(t);var r=this.formlyDesignerConfig.wrappers[this.wrapper].fields;C(r)&&0<r.length?this.$modal.modal("show"):this.onApply()}}},ie.prototype.remove=function(e){var t=this.field.wrappers.indexOf(this.wrappers[e]);if(!(t<0)){var r=p.cloneDeep(this.field);r.wrappers.splice(t,1),this.field=this.formlyDesignerService.convertField(r),this.selected.emit(this.field)}},ie.prototype.onApply=function(){this.field=this.formlyDesignerService.convertField(this.fieldEdit.value),this.selected.emit(this.field),this.$modal.modal("hide")},ie.decorators=[{type:o.Component,args:[{selector:"formly-designer-wrappers-picker",template:'\n        <div class="form-group">\n            <div class="input-group">\n                <formly-designer-wrapper-picker [field]="field" (selected)="onWrapperSelected($event)">\n                </formly-designer-wrapper-picker>\n            </div>\n            <div *ngFor="let wrapper of wrappers; let i = index" class="badge badge-default noselect" (click)="edit(i)">\n                {{ wrapper }}&nbsp;&nbsp;<i class="fa fa-times" aria-hidden="true" (click)="remove(i)"></i>\n            </div>\n        </div>\n        <div #modal class="modal fade" tabindex="-1" role="dialog">\n            <div class="modal-dialog modal-lg" role="document">\n                <div class="modal-content">\n                    <div class="modal-header">\n                        <h5 class="modal-title">Edit {{ wrapper }}</h5>\n                        <button type="button" class="close" data-dismiss="modal" aria-label="Cancel">\n                            <span aria-hidden="true">&times;</span>\n                        </button>\n                    </div>\n                    <div class="modal-body">\n                        <formly-designer-wrapper-editor #editor [formControl]="fieldEdit" [wrapper]="wrapper">\n                        </formly-designer-wrapper-editor>\n                    </div>\n                    <div class="modal-footer">\n                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>\n                        <button type="button" class="btn btn-primary" (click)="onApply()"\n                            [disabled]="editor.invalid">Apply</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    ',styles:["\n        .badge {\n            margin-right: .25em;\n        }\n        .badge {\n            cursor: pointer;\n        }\n        .noselect {\n            -webkit-user-select: none;\n            -khtml-user-select: none;\n            -moz-user-select: none;\n            -ms-user-select: none;\n            user-select: none;\n        }\n    "]}]}],ie.ctorParameters=function(){return[{type:m},{type:k}]},ie.propDecorators={modalRef:[{type:o.ViewChild,args:["modal"]}],field:[{type:o.Input}],selected:[{type:o.Output}]},ie);function ie(e,t){this.formlyDesignerConfig=e,this.formlyDesignerService=t,this.selected=new o.EventEmitter,this.fieldEdit=new a.FormControl({}),this.wrappers=[]}function oe(e){if(null==e)return e;var n=1,i=new Map;return se(p.cloneDeep(e),function(e,t){if(w(t)){if(i.has(t)){var r=i.get(t);return r||(t.$id=r=n++,i.set(t,r)),{$ref:r}}i.set(t,0)}})}function se(e,t){if(C(e))for(var r=0;r<e.length;r++)le.bind(e,r,e[r],t)();else if(w(e))for(var n in e)e.hasOwnProperty(n)&&le.bind(e,n,e[n],t)();return e}function le(e,t,r){var n=r(e,t);n===undefined?se(t,r):this[e]=n}var ae=(pe.prototype.transform=function(e){return oe(e)},pe.decorators=[{type:o.Pipe,args:[{name:"decycle"}]}],pe);function pe(){}var de=(fe.forRoot=function(e){return void 0===e&&(e={}),{ngModule:fe,providers:[{provide:o.ANALYZE_FOR_ENTRY_COMPONENTS,useValue:[W,I],multi:!0},{provide:h,useValue:e,multi:!0}]}},fe.decorators=[{type:o.NgModule,args:[{declarations:[q,L,T,U,H,X,te,ne,ae,W,I],imports:[t.CommonModule,a.FormsModule,a.ReactiveFormsModule,r.FormlyModule.forChild()],exports:[T],providers:[m,D],entryComponents:[r.FormlyForm]}]}],fe.ctorParameters=function(){return[{type:r.FormlyConfig}]},fe);function fe(e){e.addConfig(_)}e.fieldComponents=W,e.wrapperComponents=I,e.config=_,e.FieldsService=D,e.FORMLY_DESIGNER_CONFIG_TOKEN=h,e.FormlyDesignerConfig=m,e.FormlyDesignerService=k,e.FormlyDesignerComponent=T,e.FormlyDesignerModule=de,e.decycle=oe,e.e=q,e.f=L,e.g=U,e.h=H,e.j=te,e.i=X,e.k=ne,e.l=ae,e.d=P,e.a=c,e.b=A,e.c=V,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-formly-designer.umd.min.js.map